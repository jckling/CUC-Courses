%% Watson对比度模型
% DC：Array of dct coefficient
% Res: Array of dct coefficient after quantification
function [Res] = WatsonContrast(DC)
t = [
        1.40,   1.01,   1.16,   1.66,   2.40,   3.43,   4.79,   6.56;
        1.01,   1.45,   1.32,   1.52,   2.00,   2.71,   3.67,   4.93;
        1.16,   1.32,   2.24,   2.59,   2.98,   3.64,   4.60,   5.88;
        1.66,   1.52,   2.59,   3.77,   4.55,   5.30,   6.28,   7.60;
        2.40,   2.00,   2.98,   4.55,   6.15,   7.46,   8.71,   10.17;
        3.43,   2.71,   3.64,   5.30,   7.46,   9.62,   11.58,  13.51;
        4.79,   3.67,   4.60,   6.28,   8.71,   11.58,  14.50,  17.29;
        6.56,   4.93,   5.88,   7.60,   10.17,  13.51,  17.29,  21.15
     ];
 
Res = DC;
[row, col] = size(DC);

for i=1:row
    for j=1:col
        Res(i,j)=max([t(i,j), (abs(DC(i,j))^0.7)*(t(i,j)^(1-0.7))]);
    end
end
Res(1,1) = max([t(1,1), (abs(DC(1,1))^0)*(t(1,1)^(1-0))]);

end